---
title: "R Notebook"
output: html_notebook
---

```{r}
source("tp7-ml/code/desafio/kaggleChallenge.R")
```

```{r}
# Cargar datos de entrenamiento y de prueba
train_data <- read.csv("tp7-ml/code/desafio/arbolado-mza-dataset.csv")
test_data <- read.csv("tp7-ml/code/desafio/arbolado-mza-dataset-test.csv")
source("tp7-ml/code/desafio/kaggleChallenge.R")
```

```{r}
# Preprocesamiento de datos: eliminar especies raras
train_data <- remove_rare_species(train_data)
```
```
```{r}
# Balanceo de clases mediante oversampling o undersampling
train_data_balanced <- perform_oversampling(train_data, method = "SMOTE")
```
```{r}
# Definir las variables predictoras y la variable objetivo
predictors <- c("altura", "circ_tronco_cm", "diametro_tronco", "especie", "seccion")
target_var <- "inclinacion_peligrosa"
```
```{r}
# Entrenar el modelo de ensamble con Random Forest y SVM
ensemble_models <- train_ensemble_model(train_data_balanced, target_var, predictors)
```
```{r}
# Realizar predicciones en el conjunto de prueba usando el ensamble
ensemble_predictions <- predict_with_ensemble(ensemble_models, test_data)
```
```{r}
# Evaluar el modelo en el conjunto de prueba
test_actual <- test_data$inclinacion_peligrosa  # Asegúrate de que los valores reales estén disponibles
evaluation_results <- evaluate_model(ensemble_predictions$inclinacion_peligrosa, test_actual)
```
```{r}
# Imprimir resultados de la evaluación
print(evaluation_results$confusion_matrix)
print(paste("AUC-ROC:", evaluation_results$auc_roc))
```
```{r}
# Guardar las predicciones en el formato de envío
write.csv(ensemble_predictions, "predicciones_finales.csv", row.names = FALSE)
```